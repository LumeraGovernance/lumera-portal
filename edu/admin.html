<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lumera Admin</title>
  <style>
    *{box-sizing:border-box}html,body{margin:0;padding:0;font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif;background:#f6f7f8;color:#111}
    .container{max-width:1200px;margin:0 auto;padding:24px}
    .topbar{position:sticky;top:0;background:#fff;border-bottom:1px solid #e6e7e8}
    .topbar .inner{display:flex;gap:12px;align-items:center;padding:12px 24px}
    .logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,#f59e0b,#10b981);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800}
    .nav{margin-left:auto;display:flex;gap:8px;align-items:center}
    .btn{padding:8px 12px;border:1px solid #d0d2d4;border-radius:10px;background:#fff;cursor:pointer}
    .access{max-width:560px;border:1px solid #e6e7e8;border-radius:16px;padding:16px;background:#fff}
    .small{font-size:12px;color:#555}
    .mono{font-family:ui-monospace,Consolas,Menlo,monospace}
    footer{border-top:1px solid #e6e7e8;padding:32px;margin-top:48px;color:#555}
  </style>
</head>
<body>
  <div id="app"></div>
  <div id="content"></div>
  <script>
    const ACCESS_KEYS=[{id:"admin-demo",role:"admin",key:"LUMERA-ADMIN-KEY-EXAMPLE"},{id:"author-demo",role:"author",key:"LUMERA-AUTHOR-KEY-EXAMPLE"}];
    function getAuth(){ try{ return JSON.parse(localStorage.getItem("lumera.auth")) || {role:"viewer"} }catch{ return {role:"viewer"} } }
    function setAuth(a){ localStorage.setItem("lumera.auth", JSON.stringify(a)); }
    function promptLogin(){ const k=prompt("Enter your Lumera user key:"); if(!k) return getAuth(); const f=ACCESS_KEYS.find(x=>x.key===k.trim()); if(f){ const next={role:f.role,keyId:f.id}; setAuth(next); alert("Signed in as "+f.role); return next;} alert("Invalid key"); return getAuth(); }
    (function(){ try{ const p=new URLSearchParams(location.search); const k=p.get("key"); if(k){ const f=ACCESS_KEYS.find(x=>x.key===k.trim()); if(f){ setAuth({role:f.role,keyId:f.id}); } history.replaceState({}, document.title, location.pathname + location.hash);} }catch{} })();

    function h(t,a={},...c){ const e=document.createElement(t); for(const k in a){ const v=a[k]; if(k==="class") e.className=v; else if(k==="style"&&typeof v==="object") Object.assign(e.style,v); else if(k.startsWith("on")&&typeof v==="function") e.addEventListener(k.slice(2).toLowerCase(),v); else e.setAttribute(k,v);} c.flat().forEach(x=>e.append(x instanceof Node?x:document.createTextNode(x))); return e; }
    function topbar(){ const auth=getAuth(); const role=auth&&auth.role?auth.role:"viewer"; return h("div",{class:"topbar"},h("div",{class:"inner"},h("div",{class:"logo"},"L"),h("a",{href:"index.html"},h("strong",{},"Lumera Admin")),h("div",{style:{flex:1}}),h("a",{class:"btn",href:"index.html"},"Catalog"),((role==="author"||role==="admin"))?h("a",{class:"btn",href:"studio.html"},"Studio"):null,(role==="admin")?h("a",{class:"btn",href:"admin.html"},"Admin"):null,h("div",{class:"nav"},h("span",{class:"small"},"Role: "+role),role==="viewer"?h("button",{class:"btn",onClick:()=>{promptLogin(); location.reload();}},"Sign in"):h("button",{class:"btn",onClick:()=>{ if(confirm('Sign out?')){ setAuth({role:'viewer'}); location.reload(); } }},"Sign out"))); }
    function guardAdmin(){ const r=getAuth().role; if(r==="admin") return true; const c=document.getElementById("content"); c.innerHTML=""; c.append(h("div",{class:"container"},h("div",{class:"access"},h("h3",{},"Access denied"),h("p",{class:"small"},"You need admin access. Use a user key to sign in."),h("button",{class:"btn",onClick:()=>{promptLogin(); location.reload();}},"Sign in")))); return false; }

    function getCourses(){ try{const v=localStorage.getItem("lumera.courses"); if(v) return JSON.parse(v);}catch{} return []; }
    function renderAdmin(){ const courses=getCourses(); const c=document.getElementById("content"); c.innerHTML=""; c.append(h("div",{class:"container"},h("h2",{},"Admin"),h("p",{},"Overview (read-only):"),h("pre",{class:"mono",style:"white-space:pre-wrap;background:#fafafa;border:1px solid #e6e7e8;padding:12px;border-radius:12px"}, JSON.stringify({courseCount:courses.length, ids:courses.map(x=>x.id)}, null, 2)))); }

    function boot(){ document.getElementById("app").append(topbar()); if(guardAdmin()) renderAdmin(); }
    document.addEventListener("DOMContentLoaded", boot);
  </script>
</body>
</html>
